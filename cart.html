<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NSMNIA WARDROBE - Cart</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&family=Playfair+Display:ital,wght@1,700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"/>
  <link rel="shortcut icon" type="image/x-icon" href="favicon2.png">
  <style>
    .empty-cart {
      text-align: center;
      padding: 30px;
      font-size: 18px;
      color: #777;
    }
    
    .user-controls {
      position: absolute;
      top: 45px;
      right: 20px;
      display: flex;
      gap: 10px;
      align-items: center;
    }
    
    .logout-btn {
      width: 90px;
      background-color: #fb914d;
      color: white;
      font-weight: bold;
      font-family: 'Open Sans';
      border-color: white;
      cursor: pointer;
      padding: 8px 12px;
      border-radius: 4px;
      display: none;
    }
    
    .logout-btn.visible {
      display: block;
    }
    
    .welcome-message {
      margin-right: 10px;
      font-size: 14px;
      font-weight: 600;
      color: #333;
      display: none;
    }
    
    .welcome-message.visible {
      display: block;
    }
    
    .cart-items {
      margin: 20px 0;
    }
    
    .cart-item {
      display: flex;
      border-bottom: 1px solid #eee;
      padding: 15px 0;
      align-items: center;
    }
    
    .cart-item-image {
      width: 100px;
      height: 100px;
      object-fit: cover;
      margin-right: 15px;
    }
    
    .cart-item-details {
      flex: 1;
    }
    
    .cart-item-title {
      font-weight: 600;
      margin-bottom: 5px;
    }
    
    .cart-item-price {
      color: #fb914d;
      font-weight: 600;
    }
    
    .cart-item-quantity {
      display: flex;
      align-items: center;
      margin: 10px 0;
    }
    
    .quantity-btn {
      background: #f5f5f5;
      border: none;
      width: 30px;
      height: 30px;
      font-size: 16px;
      cursor: pointer;
    }
    
    .quantity-input {
      width: 40px;
      height: 30px;
      text-align: center;
      margin: 0 5px;
      border: 1px solid #ddd;
    }
    
    .cart-item-remove {
      color: #f44336;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 14px;
    }
    
    .cart-summary {
      background: #f9f9f9;
      padding: 20px;
      border-radius: 5px;
      margin-top: 20px;
    }
    
    .cart-summary-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    
    .cart-summary-total {
      font-weight: 700;
      font-size: 18px;
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid #ddd;
    }
    
    .checkout-btn {
      width: 100%;
      margin-top: 15px;
      padding: 12px;
      background-color: #fb914d;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
    }
    
    .checkout-btn:hover {
      background-color: #e67e22;
    }
    
    .login-prompt {
      text-align: center;
      margin: 30px 0;
      padding: 20px;
      background-color: #f8f9fa;
      border-radius: 5px;
    }
    
    .login-prompt p {
      margin-bottom: 15px;
    }
  </style>
</head>
<body>
  <header>
    <div class="top-bar">
      <div class="call">
        <p>ðŸ•¾ Call Us: +92(0)321 6657063</p>
      </div>
      <div class="free-shipping">
        <p>Free Shipping on all orders worth Rs. 6000 & above</p>
      </div>
    </div>
    
    <nav class="main-bar">
      <div class="logo-container">
        <a href="homepage.html">
          <img src="logo2.png" alt="NSMNIA LOGO" class="logo">
        </a>
      </div>
      <ul>
        <li><a href="SALES.html">SALE</a></li>
        <li><a href="category7.html">JEWELLERY</a></li>
        <li><a href="category8.html">HANDMADE</a></li>
        <li><a href="category9.html">PRINTED KURTAS</a></li>
        <li><a href="category6.html">FORMAL KURTAS</a></li>
        <li><a href="category5.html">3-PIECE</a></li>
      </ul>
      <div class="wrap">
        <div class="search">
          <input type="text" class="searchTerm" placeholder="SEARCH">
          <button type="submit" class="search-button">
            <i class="fa fa-search"></i>
          </button>
        </div>
      </div>
    </nav>
    
    <div class="lower-header">
      <p>Nsmnia Wardrobe</p>
      <div class="user-controls">
        <span class="welcome-message">Welcome!</span>
        <button class="loginbtn" style="width:90px;background-color:#fb914d;color:white;font-weight:bold;font-family:Open Sans;border-color:white;">
          <a href="login.html">LOGIN</a>
        </button>
        <button id="logout-btn" class="logout-btn">LOGOUT</button>
        <a href="cart.html" style="display: flex; align-items: center; margin-left: 10px;">
          <i class="fas fa-shopping-cart" style="font-size: 24px; color: #fb914d;"></i>
        </a>
      </div>
    </div>
  </header>

  <main>
    <div class="cart-container">
      <h1 class="auth-title">Your Cart</h1>
      
      <div id="cart-message" class="success-message" style="display: none;"></div>
      
      <div id="login-prompt" class="login-prompt" style="display: none;">
        <p>Please log in to view your cart and complete your purchase.</p>
        <a href="login.html?redirect=cart.html" class="btn-primary">Login</a>
        <p>Don't have an account? <a href="signup.html?redirect=cart.html">Sign up</a></p>
      </div>
      
      <div id="cart-items" class="cart-items">
        <!-- Cart items will be dynamically inserted here -->
      </div>
      
      <div id="cart-summary" class="cart-summary" style="display: none;">
        <!-- Cart summary will be dynamically updated -->
      </div>
    </div>
  </main>

  <footer>
    <div class="content">
      <div class="left box">
        <div class="upper">
          <div class="topic">About us</div>
          <p>Nsmnia is a brand who believes in quality over quantity. Our goal is to provide our customers with the most exquisite pieces that showcase the <span class="text-element">finest of craftmenship</span></p>
        </div>
        <div class="lower">
          <div class="topic">Contact us</div>
          <div class="phone">
            <a href="#"><i class="fas fa-phone-volume"></i>+92 321 6657063</a>
          </div>
          <div class="email">
            <a href="#"><i class="fas fa-envelope"></i>nsmniawardrobe@gmail.com</a>
          </div>
          <div class="adress">
            <a href="#"><i class="fas fa-location-arrow"></i>Nsmnia Textile Mills Ltd.Plot No.H-7, Landhi Industrial Area, Landhi, Karachi, Pakistan.</a>
          </div>
        </div>
      </div>
      <div class="middle box">
        <div class="topic">Our Services</div>
        <div><a href="#">Home Delivery</a></div>
        <div><a href="#">Online Payment</a></div>
        <div><a href="#">Customer FAQs</a></div>
        <div><a href="#">Register Complaint</a></div>
      </div>
      <div class="right box">
        <div class="topic">Subscribe to our Newsletter<span class="Newsletter-heart"> â™¡</span></div>
        <form action="#">
          <input type="text" placeholder="Enter email address">
          <input type="submit" name="" value="Send">
          <div class="media-icons">
            <a href="https://www.facebook.com/" target="_blank"><i class="fab fa-facebook-f"></i></a>
            <a href="https://www.instagram.com/" target="_blank"><i class="fab fa-instagram"></i></a>
            <a href="https://www.pinterest.com/" target="_blank"><i class="fab fa-pinterest"></i></a>
            <a href="https://twitter.com/i/flow/login" target="_blank"><i class="fab fa-twitter"></i></a>
            <a href="https://www.youtube.com/" target="_blank"><i class="fab fa-youtube"></i></a>
            <a href="https://pk.linkedin.com/" target="_blank"><i class="fab fa-linkedin-in"></i></a>
          </div>
        </form>
      </div>
      <div class="icons-text">Follow us :</div>
    </div>
    <div class="bottom">
      <p>Copyright Â© 2025 <a href="#">Nsmnia all rights reserved</a></p>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
      const userEmail = localStorage.getItem('userEmail');
      const cartItemsContainer = document.getElementById('cart-items');
      const cartSummary = document.getElementById('cart-summary');
      const loginPrompt = document.getElementById('login-prompt');
      
      function updateUserInterface() {
        const welcomeMessage = document.querySelector('.welcome-message');
        const logoutBtn = document.getElementById('logout-btn');
        const loginBtn = document.querySelector('.loginbtn');
        
        if (isLoggedIn && userEmail) {
          // Show welcome message with user's email
          welcomeMessage.textContent = `Welcome, ${userEmail.split('@')[0]}!`;
          welcomeMessage.classList.add('visible');
          
          // Show logout button and hide login button
          logoutBtn.classList.add('visible');
          if (loginBtn) loginBtn.style.display = 'none';
          
          // Show cart content
          loginPrompt.style.display = 'none';
          displayCart();
        } else {
          // Hide welcome message and logout button, show login button
          welcomeMessage.classList.remove('visible');
          logoutBtn.classList.remove('visible');
          if (loginBtn) loginBtn.style.display = 'block';
          
          // Show login prompt
          loginPrompt.style.display = 'block';
          cartItemsContainer.innerHTML = '';
          cartSummary.style.display = 'none';
        }
      }
      
      function displayCart() {
        const cart = JSON.parse(localStorage.getItem('cart') || '[]');
        
        if (cart.length === 0) {
          cartItemsContainer.innerHTML = '<div class="empty-cart">Your cart is empty</div>';
          cartSummary.style.display = 'none';
          return;
        }
        
        // Display cart items
        cartItemsContainer.innerHTML = '';
        let subtotal = 0;
        
        cart.forEach((item, index) => {
          const itemTotal = item.price * item.quantity;
          subtotal += itemTotal;
          
          const cartItemElement = document.createElement('div');
          cartItemElement.className = 'cart-item';
          cartItemElement.innerHTML = `
            <img src="${item.image}" alt="${item.title}" class="cart-item-image">
            <div class="cart-item-details">
              <div class="cart-item-title">${item.title}</div>
              <div class="cart-item-price">Rs. ${item.price}</div>
              <div class="cart-item-quantity">
                <button class="quantity-btn decrease-btn" data-index="${index}">-</button>
                <input type="number" class="quantity-input" value="${item.quantity}" min="1" data-index="${index}">
                <button class="quantity-btn increase-btn" data-index="${index}">+</button>
              </div>
            </div>
            <button class="cart-item-remove" data-index="${index}">Remove</button>
          `;
          
          cartItemsContainer.appendChild(cartItemElement);
        });
        
        // Display cart summary
        const shipping = subtotal >= 6000 ? 0 : 300;
        const total = subtotal + shipping;
        
        cartSummary.innerHTML = `
          <div class="cart-summary-row">
            <span>Subtotal:</span>
            <span>Rs. ${subtotal}</span>
          </div>
          <div class="cart-summary-row">
            <span>Shipping:</span>
            <span>${shipping === 0 ? 'Free' : `Rs. ${shipping}`}</span>
          </div>
          <div class="cart-summary-row cart-summary-total">
            <span>Total:</span>
            <span>Rs. ${total}</span>
          </div>
          <button class="checkout-btn">Proceed to Checkout</button>
        `;
        
        cartSummary.style.display = 'block';
        
        // Add event listeners for quantity buttons
        document.querySelectorAll('.decrease-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            const index = parseInt(this.dataset.index);
            if (cart[index].quantity > 1) {
              cart[index].quantity--;
              saveCartAndUpdate(cart);
            }
          });
        });
        
        document.querySelectorAll('.increase-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            const index = parseInt(this.dataset.index);
            cart[index].quantity++;
            saveCartAndUpdate(cart);
          });
        });
        
        document.querySelectorAll('.quantity-input').forEach(input => {
          input.addEventListener('change', function() {
            const index = parseInt(this.dataset.index);
            const newQuantity = parseInt(this.value);
            if (newQuantity >= 1) {
              cart[index].quantity = newQuantity;
              saveCartAndUpdate(cart);
            }
          });
        });
        
        document.querySelectorAll('.cart-item-remove').forEach(btn => {
          btn.addEventListener('click', function() {
            const index = parseInt(this.dataset.index);
            cart.splice(index, 1);
            saveCartAndUpdate(cart);
          });
        });
      }
      
      function saveCartAndUpdate(cart) {
        // Save cart to localStorage
        localStorage.setItem('cart', JSON.stringify(cart));
        
        // If user is logged in, also update their cart in the users array
        if (isLoggedIn && userEmail) {
          const users = JSON.parse(localStorage.getItem('users') || '[]');
          const updatedUsers = users.map(user => {
            if (user.email === userEmail) {
              return { ...user, cart };
            }
            return user;
          });
          
          localStorage.setItem('users', JSON.stringify(updatedUsers));
        }
        
        // Refresh cart display
        displayCart();
      }
      
      // Add event listener for logout button
      const logoutBtn = document.getElementById('logout-btn');
      if (logoutBtn) {
        logoutBtn.addEventListener('click', function() {
          // Save current cart to user's account before logging out
          if (isLoggedIn && userEmail) {
            const cart = JSON.parse(localStorage.getItem('cart') || '[]');
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            
            const updatedUsers = users.map(user => {
              if (user.email === userEmail) {
                return { ...user, cart };
              }
              return user;
            });
            
            localStorage.setItem('users', JSON.stringify(updatedUsers));
          }
          
          // Clear login status
          localStorage.setItem('isLoggedIn', 'false');
          localStorage.removeItem('userEmail');
          localStorage.removeItem('currentUser');
          
          // Update UI
          updateUserInterface();
          
          // Show logout message
          alert('You have been logged out successfully.');
          
          // Redirect to landing page
          window.location.href = 'pro1.html';
        });
      }
      
      // Initialize the page
      updateUserInterface();
    });
  </script>
</body>
</html>
